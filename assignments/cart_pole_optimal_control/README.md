# Cart-Pole Optimal Control Assignment


**Atharv Kulkarni**

**Email: akulka96@asu.edu**

**ID: 1233494108**

**RAS598**

This document presents the analysis and tuning of an LQR controller for a cart-pole system subjected to earthquake disturbances. The objective of this assignment was to maintain the stability of the inverted pendulum while ensuring the cart remains within its ±2.5 m range, even under significant external perturbations. The following report outlines the controller design, tuning process, performance analysis, and trade-offs encountered.

---

## 1. Introduction

The cart-pole system, featuring an inverted pendulum mounted on a cart, is a classic benchmark in control systems. In this assignment, the system is further challenged by earthquake-like disturbances generated by a force generator that superimposes multiple sine waves with random variations and added Gaussian noise. The study simulates scenarios where the base amplitude of the earthquake force is varied from 15 N to 50 N. The primary goal was to design and tune an LQR controller to:
- Maintain the pole’s upright position.
- Keep the cart within its physical limits.
- Achieve robust performance under varying seismic disturbances.

---

## 2. System Description

- **Physical Setup:**
  - **Cart Traversal Range:** ±2.5 m (total 5 m)
  - **Pole Length:** 1 m
  - **Cart Mass:** 1.0 kg
  - **Pole Mass:** 1.0 kg

- **Disturbance Generator:**
  - **Base Amplitude:** Initially 15 N, increased to as high as 50 N during testing.
  - **Frequency Range:** 0.5–4.0 Hz
  - **Additional Variations:** Random amplitude and phase shifts plus Gaussian noise.

---

## 3. Controller Tuning and Methodology

### Initial and Final LQR Parameters

- **Initial Configuration:**
  - **State Cost Matrix (Q):** `diag([1.0, 1.0, 10.0, 10.0])`
  - **Control Cost (R):** `[[0.1]]`

- **Final Configuration (After Tuning):**
  - **State Cost Matrix (Q):** `diag([7.0, 2.0, 3.0, 1.0])`
  - **Control Cost (R):** `[[0.01]]`

### Justification for Parameter Changes

1. **State Cost Matrix (Q):**
   - **Increase in Weight on Cart Position:** Changing the first element from 1.0 to 7.0 increases the penalization on cart displacement. This encourages the controller to keep the cart closer to the center of the track, critical for avoiding physical constraints.
   - **Adjustment of Velocity and Angular Terms:** By reducing the weights on the angular position and velocity (from 10.0 to 3.0 and 1.0 respectively), the tuning process balanced the trade-off between aggressive stabilization and smooth control effort. This reallocation allowed the system to be more responsive to positional errors without overly penalizing small angular deviations that can be quickly corrected.
   - **Moderate Weight on Cart Velocity:** A modest increase in the second element (from 1.0 to 2.0) ensured that the controller moderated rapid movements of the cart, reducing oscillations that could be induced by seismic disturbances.

2. **Control Cost (R):**
   - **Reduction in R Value:** Lowering R from 0.1 to 0.01 reduces the penalty on the control input, allowing the controller to apply stronger forces when necessary. This adjustment was essential in counteracting higher amplitude earthquake disturbances (up to 50 N) without causing instability or saturating the actuator.

### Earthquake Base Amplitude Variation

- **Baseline vs. Amplified Disturbances:**
  - Under baseline conditions (15 N), the initial parameters maintained stability but exhibited limited robustness under higher disturbances.
  - With the final configuration, tests showed that even when the earthquake base amplitude was increased to 50 N, the cart-pole system maintained stability. This improvement is attributable to the decreased control penalty (R) and the reweighted state cost (Q), which together allowed for more aggressive and effective control responses to perturbations.

---

## 4. Trade-offs in Controller Design

The tuning process involved several trade-offs:

- **Aggressiveness vs. Smoothness:**
  - Lowering R encourages more aggressive control actions, which are beneficial in overcoming large disturbances. However, this can lead to increased actuator activity and potential wear.
  - The reallocation of Q values helped moderate this effect by ensuring that excessive control effort was only used when necessary to correct significant errors.

- **Stability vs. Responsiveness:**
  - A higher weight on cart position in Q improves stability by keeping the cart near the center. Yet, if overemphasized, it could make the controller less responsive to dynamic changes.
  - The balanced adjustment of weights ensures that the system remains stable while still being responsive to rapid disturbances, thereby avoiding overshooting or oscillatory behavior.

- **Disturbance Rejection vs. Control Effort Efficiency:**
  - The changes in Q and R resulted in a system capable of handling severe disturbances without falling. However, the trade-off is seen in the higher peak control forces, which while effective in maintaining stability, require careful management to avoid potential actuator saturation.

---

## 5. Experimental Observations

- **Stability Metrics:**
  - **Maximum Pole Angle Deviation:** Remained within acceptable limits across all test cases.
  - **RMS Cart Position Error:** Significantly reduced due to the increased weight on cart displacement.
  - **Peak Control Force:** Higher control efforts were observed during disturbance events, validating the need for a reduced R.
  - **Recovery Time:** The system demonstrated rapid recovery after disturbances, attributed to the aggressive control response.

- **Disturbance Response:**
  - The controller effectively mitigated the effects of earthquake disturbances, even at higher amplitudes (up to 50 N), by applying sufficient corrective forces while ensuring the cart did not exceed its physical limits.

---

## 6. Plots

- **Cart Position (m):** Illustrates the deviation of the cart from the center.
- **Pendulum Angle (degrees):** Displays the angular deviation of the pendulum from its upright position.
- **Control Force (N):** Shows the magnitude of the force applied by the controller during disturbances.
![Figure_3](https://github.com/user-attachments/assets/874dace9-0f13-4878-a2c5-51cc1c66e435)

---
## Video 
Link to Google Drive
https://drive.google.com/file/d/1PmQJrBnvI6Irgdl9IiE-GEXJ3pFxlEMq/view?usp=sharing
## 7. Conclusion

The tuning of the LQR controller by adjusting the Q and R matrices led to a robust performance in the presence of significant earthquake disturbances. The trade-offs between aggressiveness, stability, and control effort were carefully balanced to achieve the following:
- Reliable stabilization of the inverted pendulum.
- Maintenance of the cart within the designated physical range.
- Effective disturbance rejection even under amplified earthquake forces.

This report underscores the importance of iterative tuning and the practical challenges of managing multiple control objectives. The insights and analysis presented here will be valuable for applications involving dynamic disturbances, such as the optimal control of space robots and other high-stakes robotic systems.

---



*This README is intended to serve as a comprehensive technical report for the Cart-Pole Optimal Control Assignment and is part of the GitHub repository documentation.*


## License
This work is licensed under a [Creative Commons Attribution 4.0 International License](http://creativecommons.org/licenses/by/4.0/).
[![Creative Commons License](https://i.creativecommons.org/l/by/4.0/88x31.png)](http://creativecommons.org/licenses/by/4.0/) 
